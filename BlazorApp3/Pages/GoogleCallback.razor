@page "/google-callback"
@inject NavigationManager Nav
@inject IJSRuntime JS

<p>Signing in...</p>

@code {
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (!firstRender) return;
        var uri = new Uri(Nav.Uri);
        var query = System.Web.HttpUtility.ParseQueryString(uri.Query);
        var code = query["code"];
        if (!string.IsNullOrEmpty(code))
        {
            await JS.InvokeVoidAsync("window.opener.bcvGoogleAuthCallback", code);
            await JS.InvokeVoidAsync("window.close");
        }
    }
}
